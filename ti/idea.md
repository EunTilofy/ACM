## #1. 绘制表格

### 题目描述

给出一个 $n$ 行 $m$ 列的逗号分隔的表格，你的任务是将该表格绘制成带边框的表格，用文本的形式输出。

输出要求如下：

- 输出是一个字符矩阵，包含 $n+1$ 条横线和 $m+1$ 条竖线，其中第一行和最后一行是横线，第一列和最后一列是竖线；
- 横线上的位置输出`-`(ASCII码45)，竖线上的位置输出`|`(ASCII码124), 横线与竖线相交的位置输出`+`(ASCII码43);
- 每两条横线间隔恰好一行；
- 表格中第 $i$ 行第 $j$ 列的单元格内容应完全填在第 $i$ 条横线、第 $i+1$ 条横线、第 $j$ 条竖线、第 $j+1$ 条竖线围成的区域内，若单元格内容长度比两条竖线的间隔小，应在内容的左右两侧添加空格。

这里，我们要求每列的内容按给定的方式对齐。给出一个长度为 $m$ 且只含`L`(ASCII码76), `C`(ASCII码67), `R`(ASCII码82)的字符串 $s$，用 $s_i$ 表示 $s$ 的第 $i$ 个字符，表示第 $i$ 列采用左对齐、居中（或者右侧空格比左侧多一个）、右对齐。

在此基础上，应当使输出的表格宽度尽量小，输出满足条件的表格。

### 输入格式

输入第一行包含两个正整数 $n,m$ 表示表格的行数与列数。

第二行包含一个长度为 $m$ 的字符串 $s$, 表示每列的对齐方式。保证 $s$ 只含字符`L`, `C`, `R`.

接下来 $n$ 行，每行一个包含恰好 $m−1$ 个逗号`,`(ASCII码44)的字符串，描述表格的每一行，每个逗号分割的部分为该行的一个单元格内容。保证每个单元格内容非空，且除逗号外，只会出现数字和大小写字母。

### 输出格式

输出一个字符矩阵，表示绘制的满足条件的表格。

### 样例输入

```plain
4 3
RCL
num,card,ord
1,one,first
2,two,second
3,three,third
```

### 样例输出

```plain
+---+-----+------+
|num|card |ord   |
+---+-----+------+
|  1| one |first |
+---+-----+------+
|  2| two |second|
+---+-----+------+
|  3|three|third |
+---+-----+------+
```

**数据范围**：$n,m\le 100$，每个单元格内字符串长度不超过50。

**思路**：模拟。

**来源**：福州+厦门2019年五校联考

**预估难度**：签到题

## #2. 序列取数

### 题目描述

对于一个操作序列，现在要按照如下规则取数：

1. 如果一个数是操作序列的第一个数，那么这个数可取
2. 如果一个数比它的前一个数小，那么这个数可取

最后可以将整个操作序列取完。
现在给出一个 $1$ 到 $n$ 的排列，有两种询问：
`1 l1 r1 l2 r2`：操作序列是 $[l_1, r_1]$，不取区间 $[l_2, r_2]$ 中的数最多可以取多少个数。
`2 l1 r1 l2 r2`：操作序列是 $[l_1, r_1]$ ，在区间 $[l_2, r_2]$ 中有多少点对 $(u, v)$，使得存在一种取数的方案中，$u, v$ 是被先后连续取出的。

### 输入格式

第一行两个数 $n$，$m$ ，接下来一行 $n$ 个数描述排列 。
接下来 $m$ 行每行 $5$ 个数描述询问。

### 输出格式

第 $i$ 行一个数表示第 $i$ 个询问的答案。

**数据范围**：$n,m\le 10^5$。

### 样例输入

``` plain
7 3
2 7 3 4 1 6 5
1 2 6 4 6
1 1 7 4 5
2 1 7 3 7
```

### 样例输出

``` plain
2
4
9
```

### 样例解释

**询问1**：操作序列为`7 3 4 1 6`，不取区间`4 1 6`的数，最多可以取2个数。

**询问2**：操作序列为`2 7 1 3 4 1 6` ，不取区间 `3 4` ，则无法取走6，最多取4个。

**询问3**：操作序列为 `2 7 3 4 1 6 5`，询问区间`2 1 7 3 7`。

有如下几种取数的方法：
 `2 7 3 1 4 5 6` 其中 `(1, 3)`，`(4, 5)`，`(5, 6)`，`(1 ,4)` 可以相邻取出。
 `2 7 3 4 1 5 6` 其中`(3, 4)`，`(1, 5)`可以相邻取出。
 `2 7 3 1 4 6 5`其中`(4, 6)` 可以相邻取出。
 `2 7 3 5 4 1 6`其中`(3, 5)`，`(1, 6)`可以相邻取出。

最后答案为 $9$。

### 思路

对于第一种询问，只需要计算从 $r1$ 位置开始的最长上升子序列在区间 $[r_1 + 1, r2]$ 中的数量就可以了。需要用到倍增。

对于第二种询问，两个数 $p_i,p_j (i<j)$ 可以被先后取出有两种情况：

+ $p_j$ 是 $p_i$ 之后的第一个比 $p_i$ 大的数。
+ 假设 $p_j$ 之前第一个比它大的数为 $p_k$ ， 则应有 $i\le k < j$。

对于这两种情况分别计算。需要离线计算。

复杂度 $O(n \log n)$

**来源**：福州+厦门2019年五校联考

**预估难度**：div1 B/C

## #3 完全立方数

### 题目描述

给定 $1,2,...,n$ ，要求选取其中的 $t$ 个正整数，使得任意两个数之积不为完全立方数，求 $t$ 的最大值

$1\le n \le 5\times10^6$

### 思路

对于 $n = p_1^{c_1}\times p_2^{c_2}\times \dots \times p_k^{c_k}$，将 $c_1,\dots, c_k$对3取模，则得到一个新的数 $p$ 与 $n$ 等价，设 $num(p)$ 表示所有与 $p$ 等价的数的个数，$rev(p)$ 表示和 $p$ 相乘为完全立方数的最小的数，则 $ans += \max\{num(p),num(rev(p))\}$。

计算 $num(p)$ 的时候利用线性筛（将质因数一位位的填上）。复杂度 $O(n)$。

**来源**：原创

**预估难度**：div2 C